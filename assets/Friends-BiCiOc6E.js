import{r as x,j as e,u as Y,h as f,m as v,v as Z,H as ee,g as ae,b as F,A,d as k}from"./index-DW35rIVo.js";import{I as P}from"./input-f5AW0FoI.js";import{C as N,c as y}from"./card-CcSMtKMr.js";import{A as E,b as S}from"./avatar-BGq7Gosz.js";import{u as se,c as te,P as j,a as C}from"./index-CsyBV8c4.js";import{u as re,a as D,R as ie,I as ne}from"./index-i4fVtm5m.js";import{u as oe,P as ce}from"./index-DwyAMUi7.js";import{u as le,U as de}from"./friendsStore-Dn7j5nfJ.js";import{A as me}from"./arrow-left-DY4_iDT3.js";import{U as ue}from"./users-BN-OU-3M.js";import{L as I}from"./loader-circle-BnlNvwYj.js";import{U as xe}from"./user-plus-DBDwmKt9.js";import"./index-MnEzf-Ac.js";import"./index-D2xAthOw.js";import"./index-DN7uoSTJ.js";import"./index-DUzm_Fz5.js";var b="Tabs",[pe]=te(b,[D]),M=D(),[he,w]=pe(b),V=x.forwardRef((t,i)=>{const{__scopeTabs:c,value:s,onValueChange:n,defaultValue:d,orientation:r="horizontal",dir:m,activationMode:p="automatic",...h}=t,l=re(m),[o,u]=se({prop:s,onChange:n,defaultProp:d??"",caller:b});return e.jsx(he,{scope:c,baseId:oe(),value:o,onValueChange:u,orientation:r,dir:l,activationMode:p,children:e.jsx(j.div,{dir:l,"data-orientation":r,...h,ref:i})})});V.displayName=b;var U="TabsList",G=x.forwardRef((t,i)=>{const{__scopeTabs:c,loop:s=!0,...n}=t,d=w(U,c),r=M(c);return e.jsx(ie,{asChild:!0,...r,orientation:d.orientation,dir:d.dir,loop:s,children:e.jsx(j.div,{role:"tablist","aria-orientation":d.orientation,...n,ref:i})})});G.displayName=U;var K="TabsTrigger",$=x.forwardRef((t,i)=>{const{__scopeTabs:c,value:s,disabled:n=!1,...d}=t,r=w(K,c),m=M(c),p=H(r.baseId,s),h=O(r.baseId,s),l=s===r.value;return e.jsx(ne,{asChild:!0,...m,focusable:!n,active:l,children:e.jsx(j.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":h,"data-state":l?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:p,...d,ref:i,onMouseDown:C(t.onMouseDown,o=>{!n&&o.button===0&&o.ctrlKey===!1?r.onValueChange(s):o.preventDefault()}),onKeyDown:C(t.onKeyDown,o=>{[" ","Enter"].includes(o.key)&&r.onValueChange(s)}),onFocus:C(t.onFocus,()=>{const o=r.activationMode!=="manual";!l&&!n&&o&&r.onValueChange(s)})})})});$.displayName=K;var q="TabsContent",B=x.forwardRef((t,i)=>{const{__scopeTabs:c,value:s,forceMount:n,children:d,...r}=t,m=w(q,c),p=H(m.baseId,s),h=O(m.baseId,s),l=s===m.value,o=x.useRef(l);return x.useEffect(()=>{const u=requestAnimationFrame(()=>o.current=!1);return()=>cancelAnimationFrame(u)},[]),e.jsx(ce,{present:n||l,children:({present:u})=>e.jsx(j.div,{"data-state":l?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":p,hidden:!u,id:h,tabIndex:0,...r,ref:i,style:{...t.style,animationDuration:o.current?"0s":void 0},children:u&&d})})});B.displayName=q;function H(t,i){return`${t}-trigger-${i}`}function O(t,i){return`${t}-content-${i}`}var ve=V,fe=G,L=$,z=B;function Se(){const t=Y(),{friends:i,pendingRequests:c,isLoading:s,error:n,loadFriends:d,loadPendingRequests:r,sendFriendRequest:m,approveFriendRequest:p,rejectFriendRequest:h,removeFriend:l,clearError:o}=le(),[u,J]=x.useState(""),[g,T]=x.useState("");x.useEffect(()=>{d().catch(console.error),r().catch(console.error)},[d,r]),x.useEffect(()=>{n&&(alert(n),o())},[n,o]);const _=async()=>{if(!g.trim()){alert("请输入用户ID");return}try{await m(g.trim()),alert("好友请求已发送"),T("")}catch{}},Q=async a=>{try{await p(a),alert("已添加为好友")}catch{}},W=async a=>{try{await h(a),alert("已拒绝请求")}catch{}},X=async a=>{if(confirm("确定要删除该好友吗？"))try{await l(a),alert("已删除好友")}catch{}},R=i.filter(a=>a.nickname.toLowerCase().includes(u.toLowerCase())||a.user_id.toLowerCase().includes(u.toLowerCase()));return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-6 py-8 max-w-4xl",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(f,{variant:"ghost",onClick:()=>t("/"),className:"gap-2",children:[e.jsx(me,{size:18}),"返回首页"]})}),e.jsxs(v.div,{variants:Z,initial:"hidden",animate:"visible",className:"mb-8 flex items-center gap-4",children:[e.jsx(ue,{size:32,className:"text-green-500"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"好友管理"}),e.jsx("p",{className:"text-muted-foreground",children:"管理您的好友关系"})]})]}),e.jsx(v.div,{variants:ee,initial:"hidden",animate:"visible",transition:{delay:.1},children:e.jsx(N,{className:"mb-6",children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{placeholder:"输入用户ID添加好友",value:g,onChange:a=>T(a.target.value),onKeyPress:a=>a.key==="Enter"&&_(),className:"flex-1",disabled:s}),e.jsxs(f,{onClick:_,className:"gap-2",disabled:s,children:[s?e.jsx(I,{size:18,className:"animate-spin"}):e.jsx(xe,{size:18}),"发送请求"]})]})})})}),e.jsx(v.div,{variants:ae,initial:"hidden",animate:"visible",transition:{delay:.2},children:e.jsxs(ve,{defaultValue:"friends",className:"w-full",children:[e.jsxs(fe,{className:"flex border-b",children:[e.jsxs(L,{value:"friends",className:"flex-1 px-4 py-2 text-sm font-medium border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:text-primary",children:["我的好友 (",i.length,")"]}),e.jsxs(L,{value:"requests",className:"flex-1 px-4 py-2 text-sm font-medium border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:text-primary",children:["好友请求 (",c.length,")"]})]}),e.jsxs(z,{value:"friends",className:"mt-4",children:[e.jsx(P,{placeholder:"搜索好友",value:u,onChange:a=>J(a.target.value),className:"mb-4"}),e.jsx(N,{children:e.jsx(y,{className:"pt-6",children:s&&i.length===0?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(I,{size:32,className:"animate-spin text-muted-foreground"})}):R.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"暂无好友"}):e.jsx(v.div,{variants:F,initial:"hidden",animate:"visible",className:"space-y-4",children:e.jsx(A,{children:R.map(a=>e.jsxs(v.div,{variants:k,layout:!0,className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{className:"h-12 w-12",children:e.jsx(S,{className:"bg-gradient-to-br from-green-400 to-blue-500 text-white",children:a.nickname[0]})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.nickname}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",a.user_id]})]})]}),e.jsxs(f,{variant:"destructive",size:"sm",className:"gap-2",onClick:()=>X(a.user_id),disabled:s,children:[e.jsx(de,{size:16}),"删除"]})]},a.user_id))})})})})]}),e.jsx(z,{value:"requests",className:"mt-4",children:e.jsx(N,{children:e.jsx(y,{className:"pt-6",children:s&&c.length===0?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(I,{size:32,className:"animate-spin text-muted-foreground"})}):c.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"暂无好友请求"}):e.jsx(v.div,{variants:F,initial:"hidden",animate:"visible",className:"space-y-4",children:e.jsx(A,{children:c.map(a=>e.jsxs(v.div,{variants:k,layout:!0,className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{className:"h-12 w-12",children:e.jsx(S,{className:"bg-gradient-to-br from-purple-400 to-pink-500 text-white",children:a.nickname[0]})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.nickname}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",a.applicant_user_id]}),a.reason&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["留言: ",a.reason]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{size:"sm",onClick:()=>Q(a.applicant_user_id),disabled:s,children:"接受"}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>W(a.applicant_user_id),disabled:s,children:"拒绝"})]})]},a.applicant_user_id))})})})})})]})})]})})}export{Se as default};
